<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:AgValoniaGPS.ViewModels"
             mc:Ignorable="d"
             x:Class="AgValoniaGPS.Views.Controls.Panels.JobMenuPanel"
             x:DataType="vm:MainViewModel"
             IsVisible="{Binding IsJobMenuPanelVisible}"
             IsHitTestVisible="{Binding IsJobMenuPanelVisible}">

    <UserControl.Styles>
        <Style Selector="Border.FloatingPanel">
            <Setter Property="Background" Value="#DD1E2A38"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="8"/>
            <Setter Property="BorderBrush" Value="#444"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>
        <Style Selector="Button.ModernButton">
            <Setter Property="Background" Value="#DD34495E"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>
        <Style Selector="Button.ModernButton:pointerover">
            <Setter Property="Background" Value="#DD475A6E"/>
        </Style>
    </UserControl.Styles>

    <Border Classes="FloatingPanel" MinWidth="400" IsVisible="{Binding IsJobMenuPanelVisible}" IsHitTestVisible="True">
        <StackPanel Spacing="4" Background="Transparent">
            <Grid x:Name="DragHandle" ColumnDefinitions="Auto,*,Auto" Height="32" Margin="0,0,0,8"
                  Background="#DD2C3E50" Cursor="Hand" ToolTip.Tip="Drag to move">
                <TextBlock Grid.Column="0" Text="=" Foreground="#AAA" FontSize="20" FontWeight="Bold"
                           VerticalAlignment="Center" Margin="8,0,8,0" IsHitTestVisible="False"/>
                <TextBlock Grid.Column="1" Text="Start New Field" Foreground="White" FontSize="16" FontWeight="Bold"
                           VerticalAlignment="Center" IsHitTestVisible="False"/>
                <Button Grid.Column="2" Content="X" Width="24" Height="24" Padding="0" BorderThickness="0"
                        Background="Transparent" Foreground="#888" FontSize="16" Cursor="Hand"
                        Command="{Binding ToggleJobMenuPanelCommand}" Margin="8,0,8,0"/>
            </Grid>

            <Separator Height="1" Background="#444" Margin="0,0,0,4"/>

            <!-- Menu Items: 2-column layout (6 rows x 2 columns) -->
            <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto,Auto,Auto,Auto,Auto" ColumnSpacing="4" Background="Transparent">
                <!-- Row 0: ISO-XML, Close -->
                <Button Grid.Column="0" Grid.Row="0" Classes="ModernButton" HorizontalAlignment="Stretch" Margin="0,2" Height="44"
                        ClickMode="Press" Command="{Binding ShowIsoXmlImportDialogCommand}">
                    <StackPanel Orientation="Horizontal" Spacing="6" IsHitTestVisible="False">
                        <Image Source="avares://AgValoniaGPS.Views/Assets/Icons/ISOXML.png" Width="28" Height="28"/>
                        <TextBlock Text="ISO-XML" VerticalAlignment="Center" FontSize="12"/>
                    </StackPanel>
                </Button>
                <Button Grid.Column="1" Grid.Row="0" Classes="ModernButton" HorizontalAlignment="Stretch" Margin="0,2" Height="44"
                        ClickMode="Press" Command="{Binding CloseFieldCommand}"
                        IsEnabled="{Binding IsFieldOpen}">
                    <StackPanel Orientation="Horizontal" Spacing="6" IsHitTestVisible="False">
                        <Image Source="avares://AgValoniaGPS.Views/Assets/Icons/FileClose.png" Width="28" Height="28"/>
                        <TextBlock Text="Close" VerticalAlignment="Center" FontSize="12"/>
                    </StackPanel>
                </Button>

                <!-- Row 1: From KML, Drive In -->
                <Button Grid.Column="0" Grid.Row="1" Classes="ModernButton" HorizontalAlignment="Stretch" Margin="0,2" Height="44"
                        ClickMode="Press" Command="{Binding ShowKmlImportDialogCommand}">
                    <StackPanel Orientation="Horizontal" Spacing="6" IsHitTestVisible="False">
                        <Image Source="avares://AgValoniaGPS.Views/Assets/Icons/GoogleEarth.png" Width="28" Height="28"/>
                        <TextBlock Text="From KML" VerticalAlignment="Center" FontSize="12"/>
                    </StackPanel>
                </Button>
                <Button Grid.Column="1" Grid.Row="1" Classes="ModernButton" HorizontalAlignment="Stretch" Margin="0,2" Height="44"
                        ClickMode="Press" Command="{Binding DriveInCommand}">
                    <StackPanel Orientation="Horizontal" Spacing="6" IsHitTestVisible="False">
                        <Image Source="avares://AgValoniaGPS.Views/Assets/Icons/SteerDriveOn.png" Width="28" Height="28"/>
                        <TextBlock Text="Drive In" VerticalAlignment="Center" FontSize="12"/>
                    </StackPanel>
                </Button>

                <!-- Row 2: From Existing, Open -->
                <Button Grid.Column="0" Grid.Row="2" Classes="ModernButton" HorizontalAlignment="Stretch" Margin="0,2" Height="44"
                        ClickMode="Press" Command="{Binding ShowFromExistingFieldDialogCommand}">
                    <StackPanel Orientation="Horizontal" Spacing="6" IsHitTestVisible="False">
                        <Image Source="avares://AgValoniaGPS.Views/Assets/Icons/FileExisting.png" Width="28" Height="28"/>
                        <TextBlock Text="From Existing" VerticalAlignment="Center" FontSize="12"/>
                    </StackPanel>
                </Button>
                <Button Grid.Column="1" Grid.Row="2" Classes="ModernButton" HorizontalAlignment="Stretch" Margin="0,2" Height="44"
                        ClickMode="Press" Command="{Binding ShowFieldSelectionDialogCommand}">
                    <StackPanel Orientation="Horizontal" Spacing="6" IsHitTestVisible="False">
                        <Image Source="avares://AgValoniaGPS.Views/Assets/Icons/FileOpen.png" Width="28" Height="28"/>
                        <TextBlock Text="Open" VerticalAlignment="Center" FontSize="12"/>
                    </StackPanel>
                </Button>

                <!-- Row 3: New From Default, Resume -->
                <Button Grid.Column="0" Grid.Row="3" Classes="ModernButton" HorizontalAlignment="Stretch" Margin="0,2" Height="44"
                        ClickMode="Press" Command="{Binding ShowNewFieldDialogCommand}">
                    <StackPanel Orientation="Horizontal" Spacing="6" IsHitTestVisible="False">
                        <Image Source="avares://AgValoniaGPS.Views/Assets/Icons/FileNew.png" Width="28" Height="28"/>
                        <TextBlock Text="New From Default" VerticalAlignment="Center" FontSize="12"/>
                    </StackPanel>
                </Button>
                <Button Grid.Column="1" Grid.Row="3" Classes="ModernButton" HorizontalAlignment="Stretch" Margin="0,2" Height="44"
                        ClickMode="Press" Command="{Binding ResumeFieldCommand}">
                    <StackPanel Orientation="Horizontal" Spacing="6" IsHitTestVisible="False">
                        <Image Source="avares://AgValoniaGPS.Views/Assets/Icons/FilePrevious.png" Width="28" Height="28"/>
                        <TextBlock Text="Resume" VerticalAlignment="Center" FontSize="12"/>
                    </StackPanel>
                </Button>

                <!-- Row 4: AgShare Download, AgShare Upload -->
                <Button Grid.Column="0" Grid.Row="4" Classes="ModernButton" HorizontalAlignment="Stretch" Margin="0,2" Height="44"
                        ClickMode="Press" Command="{Binding ShowAgShareDownloadDialogCommand}">
                    <StackPanel Orientation="Horizontal" Spacing="6" IsHitTestVisible="False">
                        <Image Source="avares://AgValoniaGPS.Views/Assets/Icons/AgShare.png" Width="28" Height="28"/>
                        <TextBlock Text="AgShare Download" VerticalAlignment="Center" FontSize="12"/>
                    </StackPanel>
                </Button>
                <Button Grid.Column="1" Grid.Row="4" Classes="ModernButton" HorizontalAlignment="Stretch" Margin="0,2" Height="44"
                        ClickMode="Press" Command="{Binding ShowAgShareUploadDialogCommand}">
                    <StackPanel Orientation="Horizontal" Spacing="6" IsHitTestVisible="False">
                        <Image Source="avares://AgValoniaGPS.Views/Assets/Icons/AgShare.png" Width="28" Height="28"/>
                        <TextBlock Text="AgShare Upload" VerticalAlignment="Center" FontSize="12"/>
                    </StackPanel>
                </Button>

                <!-- Row 5: Offset Fix -->
                <Button Grid.Column="0" Grid.Row="5" Classes="ModernButton" HorizontalAlignment="Stretch" Margin="0,2" Height="44"
                        ClickMode="Press">
                    <StackPanel Orientation="Horizontal" Spacing="6" IsHitTestVisible="False">
                        <Image Source="avares://AgValoniaGPS.Views/Assets/Icons/YouTurnReverse.png" Width="28" Height="28"/>
                        <TextBlock Text="Offset Fix" VerticalAlignment="Center" FontSize="12"/>
                    </StackPanel>
                </Button>
            </Grid>

            <!-- Current Field Display -->
            <Border Background="#DD1E8449" CornerRadius="6" Padding="8,4" Margin="0,8,0,0"
                    IsVisible="{Binding IsFieldOpen}">
                <TextBlock Text="{Binding CurrentFieldName, StringFormat='Current Field: {0}'}"
                           Foreground="White"
                           FontSize="13"
                           FontWeight="SemiBold"
                           TextWrapping="Wrap"
                           HorizontalAlignment="Center"/>
            </Border>
        </StackPanel>
    </Border>
</UserControl>
