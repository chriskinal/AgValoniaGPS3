<!--
AgValoniaGPS
Copyright (C) 2024-2025 AgValoniaGPS Contributors

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program. If not, see <https://www.gnu.org/licenses/>.
-->
<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="clr-namespace:AgValoniaGPS.ViewModels;assembly=AgValoniaGPS.ViewModels"
             xmlns:conv="clr-namespace:AgValoniaGPS.Views.Converters;assembly=AgValoniaGPS.Views"
             mc:Ignorable="d" d:DesignWidth="620" d:DesignHeight="500"
             x:Class="AgValoniaGPS.Views.Controls.Dialogs.Configuration.DisplayConfigTab"
             x:DataType="vm:ConfigurationViewModel">

    <UserControl.Styles>
        <!-- Display Toggle Button with custom template to remove hover overlay -->
        <Style Selector="Button.DisplayToggle">
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="Width" Value="90"/>
            <Setter Property="Height" Value="90"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Padding" Value="8"/>
            <Setter Property="Template">
                <ControlTemplate>
                    <Border Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="{TemplateBinding CornerRadius}"
                            Padding="{TemplateBinding Padding}">
                        <ContentPresenter Content="{TemplateBinding Content}"
                                          HorizontalAlignment="Center"
                                          VerticalAlignment="Center"/>
                    </Border>
                </ControlTemplate>
            </Setter>
        </Style>

        <!-- Units Toggle Button with custom template -->
        <Style Selector="Button.UnitsToggle">
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Padding" Value="4"/>
            <Setter Property="Template">
                <ControlTemplate>
                    <Border Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="{TemplateBinding CornerRadius}"
                            Padding="{TemplateBinding Padding}">
                        <ContentPresenter Content="{TemplateBinding Content}"
                                          HorizontalAlignment="Center"
                                          VerticalAlignment="Center"/>
                    </Border>
                </ControlTemplate>
            </Setter>
        </Style>

        <!-- Tappable Value Button -->
        <Style Selector="Button.TappableValue">
            <Setter Property="Background" Value="#DD1E2A38"/>
            <Setter Property="BorderBrush" Value="#555"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="Width" Value="90"/>
            <Setter Property="Height" Value="90"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Padding" Value="8"/>
        </Style>
        <Style Selector="Button.TappableValue:pointerover">
            <Setter Property="Background" Value="#DD2A3A4A"/>
            <Setter Property="BorderBrush" Value="#4A9A7E"/>
        </Style>
    </UserControl.Styles>

    <Grid RowDefinitions="Auto,*">
        <!-- Header -->
        <TextBlock Text="Display Options" FontSize="18" FontWeight="SemiBold" Foreground="White" Margin="16,12,16,8"/>

        <ScrollViewer Grid.Row="1">
            <StackPanel Spacing="16" Margin="16,8,16,16">
                <!-- Main Toggle Grid: 4 columns x 4 rows -->
                <Border Background="#DD253545" CornerRadius="8" Padding="20">
                    <Grid ColumnDefinitions="*,*,*,*" RowDefinitions="Auto,Auto,Auto,Auto"
                          RowSpacing="12" ColumnSpacing="12" HorizontalAlignment="Center">

                        <!-- Row 0: Polygons, Speedo, Keyboard, Headland Dist -->
                        <StackPanel Grid.Row="0" Grid.Column="0" Spacing="4" HorizontalAlignment="Center">
                            <Button Classes="DisplayToggle"
                                    Background="{Binding Display.PolygonsVisible, Converter={x:Static conv:BoolToToggleBackgroundConverter.Instance}}"
                                    BorderBrush="{Binding Display.PolygonsVisible, Converter={x:Static conv:BoolToToggleBorderConverter.Instance}}"
                                    Command="{Binding TogglePolygonsCommand}">
                                <Image Source="avares://AgValoniaGPS.Views/Assets/Icons/Config/ConD_Poligons.png"
                                       Width="60" Height="60" Stretch="Uniform"/>
                            </Button>
                            <TextBlock Text="Polygons" Foreground="#AAA" FontSize="11" HorizontalAlignment="Center"/>
                        </StackPanel>

                        <StackPanel Grid.Row="0" Grid.Column="1" Spacing="4" HorizontalAlignment="Center">
                            <Button Classes="DisplayToggle"
                                    Background="{Binding Display.SpeedometerVisible, Converter={x:Static conv:BoolToToggleBackgroundConverter.Instance}}"
                                    BorderBrush="{Binding Display.SpeedometerVisible, Converter={x:Static conv:BoolToToggleBorderConverter.Instance}}"
                                    Command="{Binding ToggleSpeedometerCommand}">
                                <Image Source="avares://AgValoniaGPS.Views/Assets/Icons/Config/ConD_Speedometer.png"
                                       Width="60" Height="60" Stretch="Uniform"/>
                            </Button>
                            <TextBlock Text="Speedo" Foreground="#AAA" FontSize="11" HorizontalAlignment="Center"/>
                        </StackPanel>

                        <StackPanel Grid.Row="0" Grid.Column="2" Spacing="4" HorizontalAlignment="Center">
                            <Button Classes="DisplayToggle"
                                    Background="{Binding Display.KeyboardEnabled, Converter={x:Static conv:BoolToToggleBackgroundConverter.Instance}}"
                                    BorderBrush="{Binding Display.KeyboardEnabled, Converter={x:Static conv:BoolToToggleBorderConverter.Instance}}"
                                    Command="{Binding ToggleKeyboardCommand}">
                                <Image Source="avares://AgValoniaGPS.Views/Assets/Icons/Config/ConD_KeyBoard.png"
                                       Width="60" Height="60" Stretch="Uniform"/>
                            </Button>
                            <TextBlock Text="Keyboard" Foreground="#AAA" FontSize="11" HorizontalAlignment="Center"/>
                        </StackPanel>

                        <StackPanel Grid.Row="0" Grid.Column="3" Spacing="4" HorizontalAlignment="Center">
                            <Button Classes="DisplayToggle"
                                    Background="{Binding Display.HeadlandDistanceVisible, Converter={x:Static conv:BoolToToggleBackgroundConverter.Instance}}"
                                    BorderBrush="{Binding Display.HeadlandDistanceVisible, Converter={x:Static conv:BoolToToggleBorderConverter.Instance}}"
                                    Command="{Binding ToggleHeadlandDistanceCommand}">
                                <Image Source="avares://AgValoniaGPS.Views/Assets/Icons/Config/ConD_LightBar.png"
                                       Width="60" Height="60" Stretch="Uniform"/>
                            </Button>
                            <TextBlock Text="Headland Dist" Foreground="#AAA" FontSize="11" HorizontalAlignment="Center"/>
                        </StackPanel>

                        <!-- Row 1: Brightness, Svenn Arrow, Start Fullscreen, Elevation Log -->
                        <StackPanel Grid.Row="1" Grid.Column="0" Spacing="4" HorizontalAlignment="Center">
                            <Button Classes="DisplayToggle"
                                    Background="{Binding Display.AutoDayNight, Converter={x:Static conv:BoolToToggleBackgroundConverter.Instance}}"
                                    BorderBrush="{Binding Display.AutoDayNight, Converter={x:Static conv:BoolToToggleBorderConverter.Instance}}"
                                    Command="{Binding ToggleAutoDayNightCommand}">
                                <Image Source="avares://AgValoniaGPS.Views/Assets/Icons/Config/ConD_AutoDayNight.png"
                                       Width="60" Height="60" Stretch="Uniform"/>
                            </Button>
                            <TextBlock Text="Brightness" Foreground="#AAA" FontSize="11" HorizontalAlignment="Center"/>
                        </StackPanel>

                        <StackPanel Grid.Row="1" Grid.Column="1" Spacing="4" HorizontalAlignment="Center">
                            <Button Classes="DisplayToggle"
                                    Background="{Binding Display.SvennArrowVisible, Converter={x:Static conv:BoolToToggleBackgroundConverter.Instance}}"
                                    BorderBrush="{Binding Display.SvennArrowVisible, Converter={x:Static conv:BoolToToggleBorderConverter.Instance}}"
                                    Command="{Binding ToggleSvennArrowCommand}">
                                <Image Source="avares://AgValoniaGPS.Views/Assets/Icons/Config/ConD_RollHelper.png"
                                       Width="60" Height="60" Stretch="Uniform"/>
                            </Button>
                            <TextBlock Text="Svenn Arrow" Foreground="#AAA" FontSize="11" HorizontalAlignment="Center"/>
                        </StackPanel>

                        <StackPanel Grid.Row="1" Grid.Column="2" Spacing="4" HorizontalAlignment="Center">
                            <Button Classes="DisplayToggle"
                                    Background="{Binding Display.StartFullscreen, Converter={x:Static conv:BoolToToggleBackgroundConverter.Instance}}"
                                    BorderBrush="{Binding Display.StartFullscreen, Converter={x:Static conv:BoolToToggleBorderConverter.Instance}}"
                                    Command="{Binding ToggleStartFullscreenCommand}">
                                <Image Source="avares://AgValoniaGPS.Views/Assets/Icons/Config/ConD_FullScreenBegin.png"
                                       Width="60" Height="60" Stretch="Uniform"/>
                            </Button>
                            <TextBlock Text="Fullscreen" Foreground="#AAA" FontSize="11" HorizontalAlignment="Center"/>
                        </StackPanel>

                        <StackPanel Grid.Row="1" Grid.Column="3" Spacing="4" HorizontalAlignment="Center">
                            <Button Classes="DisplayToggle"
                                    Background="{Binding Display.ElevationLogEnabled, Converter={x:Static conv:BoolToToggleBackgroundConverter.Instance}}"
                                    BorderBrush="{Binding Display.ElevationLogEnabled, Converter={x:Static conv:BoolToToggleBorderConverter.Instance}}"
                                    Command="{Binding ToggleElevationLogCommand}">
                                <Image Source="avares://AgValoniaGPS.Views/Assets/Icons/Config/ConD_LogElevation.png"
                                       Width="60" Height="60" Stretch="Uniform"/>
                            </Button>
                            <TextBlock Text="Elevation Log" Foreground="#AAA" FontSize="11" HorizontalAlignment="Center"/>
                        </StackPanel>

                        <!-- Row 2: Field Texture, Grid, Extra Guidelines, Guidelines Count -->
                        <StackPanel Grid.Row="2" Grid.Column="0" Spacing="4" HorizontalAlignment="Center">
                            <Button Classes="DisplayToggle"
                                    Background="{Binding Display.FieldTextureVisible, Converter={x:Static conv:BoolToToggleBackgroundConverter.Instance}}"
                                    BorderBrush="{Binding Display.FieldTextureVisible, Converter={x:Static conv:BoolToToggleBorderConverter.Instance}}"
                                    Command="{Binding ToggleFieldTextureCommand}">
                                <Image Source="avares://AgValoniaGPS.Views/Assets/Icons/Config/ConD_FloorTexture.png"
                                       Width="60" Height="60" Stretch="Uniform"/>
                            </Button>
                            <TextBlock Text="Field Texture" Foreground="#AAA" FontSize="11" HorizontalAlignment="Center"/>
                        </StackPanel>

                        <StackPanel Grid.Row="2" Grid.Column="1" Spacing="4" HorizontalAlignment="Center">
                            <Button Classes="DisplayToggle"
                                    Background="{Binding Display.GridVisible, Converter={x:Static conv:BoolToToggleBackgroundConverter.Instance}}"
                                    BorderBrush="{Binding Display.GridVisible, Converter={x:Static conv:BoolToToggleBorderConverter.Instance}}"
                                    Command="{Binding ToggleGridCommand}">
                                <Image Source="avares://AgValoniaGPS.Views/Assets/Icons/Config/ConD_Grid.png"
                                       Width="60" Height="60" Stretch="Uniform"/>
                            </Button>
                            <TextBlock Text="Grid" Foreground="#AAA" FontSize="11" HorizontalAlignment="Center"/>
                        </StackPanel>

                        <StackPanel Grid.Row="2" Grid.Column="2" Spacing="4" HorizontalAlignment="Center">
                            <Button Classes="DisplayToggle"
                                    Background="{Binding Display.ExtraGuidelines, Converter={x:Static conv:BoolToToggleBackgroundConverter.Instance}}"
                                    BorderBrush="{Binding Display.ExtraGuidelines, Converter={x:Static conv:BoolToToggleBorderConverter.Instance}}"
                                    Command="{Binding ToggleExtraGuidelinesCommand}">
                                <Image Source="avares://AgValoniaGPS.Views/Assets/Icons/Config/ConD_ExtraGuides.png"
                                       Width="60" Height="60" Stretch="Uniform"/>
                            </Button>
                            <TextBlock Text="Extra Guides" Foreground="#AAA" FontSize="11" HorizontalAlignment="Center"/>
                        </StackPanel>

                        <StackPanel Grid.Row="2" Grid.Column="3" Spacing="4" HorizontalAlignment="Center">
                            <Button Classes="TappableValue" Command="{Binding EditExtraGuidelinesCountCommand}">
                                <TextBlock Text="{Binding Display.ExtraGuidelinesCount}"
                                           Foreground="White" FontWeight="Bold" FontSize="32"
                                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Button>
                            <TextBlock Text="Guide Count" Foreground="#AAA" FontSize="11" HorizontalAlignment="Center"/>
                        </StackPanel>

                        <!-- Row 3: Line Smooth, Direction Markers, Section Lines -->
                        <StackPanel Grid.Row="3" Grid.Column="0" Spacing="4" HorizontalAlignment="Center">
                            <Button Classes="DisplayToggle"
                                    Background="{Binding Display.LineSmoothEnabled, Converter={x:Static conv:BoolToToggleBackgroundConverter.Instance}}"
                                    BorderBrush="{Binding Display.LineSmoothEnabled, Converter={x:Static conv:BoolToToggleBorderConverter.Instance}}"
                                    Command="{Binding ToggleLineSmoothCommand}">
                                <Image Source="avares://AgValoniaGPS.Views/Assets/Icons/Config/ConD_LineSmooth.png"
                                       Width="60" Height="60" Stretch="Uniform"/>
                            </Button>
                            <TextBlock Text="Line Smooth" Foreground="#AAA" FontSize="11" HorizontalAlignment="Center"/>
                        </StackPanel>

                        <StackPanel Grid.Row="3" Grid.Column="1" Spacing="4" HorizontalAlignment="Center">
                            <Button Classes="DisplayToggle"
                                    Background="{Binding Display.DirectionMarkersVisible, Converter={x:Static conv:BoolToToggleBackgroundConverter.Instance}}"
                                    BorderBrush="{Binding Display.DirectionMarkersVisible, Converter={x:Static conv:BoolToToggleBorderConverter.Instance}}"
                                    Command="{Binding ToggleDirectionMarkersCommand}">
                                <Image Source="avares://AgValoniaGPS.Views/Assets/Icons/Config/ConD_DirectionMarker.png"
                                       Width="60" Height="60" Stretch="Uniform"/>
                            </Button>
                            <TextBlock Text="Direction" Foreground="#AAA" FontSize="11" HorizontalAlignment="Center"/>
                        </StackPanel>

                        <StackPanel Grid.Row="3" Grid.Column="2" Spacing="4" HorizontalAlignment="Center">
                            <Button Classes="DisplayToggle"
                                    Background="{Binding Display.SectionLinesVisible, Converter={x:Static conv:BoolToToggleBackgroundConverter.Instance}}"
                                    BorderBrush="{Binding Display.SectionLinesVisible, Converter={x:Static conv:BoolToToggleBorderConverter.Instance}}"
                                    Command="{Binding ToggleSectionLinesCommand}">
                                <Image Source="avares://AgValoniaGPS.Views/Assets/Icons/Config/ConD_SectionHighlights.png"
                                       Width="60" Height="60" Stretch="Uniform"/>
                            </Button>
                            <TextBlock Text="Section Lines" Foreground="#AAA" FontSize="11" HorizontalAlignment="Center"/>
                        </StackPanel>

                        <!-- Units Section (Row 3, Column 3) -->
                        <StackPanel Grid.Row="3" Grid.Column="3" Spacing="4" HorizontalAlignment="Center">
                            <TextBlock Text="Units" Foreground="White" FontSize="12" FontWeight="SemiBold"
                                       HorizontalAlignment="Center" Margin="0,0,0,4"/>
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <Button Classes="UnitsToggle" Width="40" Height="40"
                                        Background="{Binding Config.IsMetric, Converter={x:Static conv:BoolToToggleBackgroundConverter.Instance}}"
                                        BorderBrush="{Binding Config.IsMetric, Converter={x:Static conv:BoolToToggleBorderConverter.Instance}}"
                                        Command="{Binding SetMetricUnitsCommand}">
                                    <Image Source="avares://AgValoniaGPS.Views/Assets/Icons/Config/ConD_Metric.png"
                                           Width="28" Height="28" Stretch="Uniform"/>
                                </Button>
                                <Button Classes="UnitsToggle" Width="40" Height="40"
                                        Background="{Binding !Config.IsMetric, Converter={x:Static conv:BoolToToggleBackgroundConverter.Instance}}"
                                        BorderBrush="{Binding !Config.IsMetric, Converter={x:Static conv:BoolToToggleBorderConverter.Instance}}"
                                        Command="{Binding SetImperialUnitsCommand}">
                                    <Image Source="avares://AgValoniaGPS.Views/Assets/Icons/Config/ConD_Imperial.png"
                                           Width="28" Height="28" Stretch="Uniform"/>
                                </Button>
                            </StackPanel>
                        </StackPanel>
                    </Grid>
                </Border>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</UserControl>
