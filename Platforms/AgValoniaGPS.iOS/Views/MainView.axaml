<UserControl xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="using:AgValoniaGPS.ViewModels"
        xmlns:controls="using:AgValoniaGPS.Views.Controls"
        mc:Ignorable="d" d:DesignWidth="1194" d:DesignHeight="834"
        x:Class="AgValoniaGPS.iOS.Views.MainView"
        x:DataType="vm:MainViewModel"
        Background="#1a1a1a">

    <UserControl.Styles>
        <!-- Mobile-friendly button style -->
        <Style Selector="Button.MobileButton">
            <Setter Property="Width" Value="60"/>
            <Setter Property="Height" Value="60"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Background" Value="#DD2C3E50"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="0"/>
        </Style>
        <Style Selector="Button.MobileButton:pointerover">
            <Setter Property="Background" Value="#DD3498DB"/>
        </Style>
        <Style Selector="Button.MobileButton:pressed">
            <Setter Property="Background" Value="#DD1ABC9C"/>
        </Style>

        <!-- Small mobile button -->
        <Style Selector="Button.MobileButtonSmall">
            <Setter Property="Width" Value="50"/>
            <Setter Property="Height" Value="50"/>
            <Setter Property="CornerRadius" Value="10"/>
            <Setter Property="Background" Value="#DD2C3E50"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="0"/>
        </Style>
        <Style Selector="Button.MobileButtonSmall:pointerover">
            <Setter Property="Background" Value="#DD3498DB"/>
        </Style>

        <!-- Status panel style -->
        <Style Selector="Border.StatusPanel">
            <Setter Property="Background" Value="#CC1a1a1a"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="12,8"/>
        </Style>
    </UserControl.Styles>

    <!-- Full-screen layout -->
    <Grid>
        <!-- FULL SCREEN MAP - Using Avalonia.Labs SKCanvasView -->
        <controls:SkiaMapControlLabs x:Name="MapControl" IsGridVisible="True" />

        <!-- TOP-LEFT: GPS Status -->
        <Border Classes="StatusPanel"
                Margin="20,40,0,0"
                HorizontalAlignment="Left"
                VerticalAlignment="Top">
            <StackPanel Orientation="Horizontal" Spacing="12">
                <Ellipse Width="16" Height="16" Fill="#3498DB"/>
                <TextBlock Text="{Binding FixQuality}" Foreground="White" FontSize="18" FontWeight="Bold" VerticalAlignment="Center"/>
            </StackPanel>
        </Border>

        <!-- TOP-CENTER: Speed Display -->
        <Border Classes="StatusPanel"
                Margin="0,40,0,0"
                HorizontalAlignment="Center"
                VerticalAlignment="Top">
            <StackPanel Orientation="Horizontal" Spacing="8">
                <TextBlock Text="{Binding Speed, StringFormat={}{0:F1}}" Foreground="White" FontSize="32" FontWeight="Bold" VerticalAlignment="Center"/>
                <TextBlock Text="km/h" Foreground="#888" FontSize="16" VerticalAlignment="Bottom" Margin="0,0,0,4"/>
            </StackPanel>
        </Border>

        <!-- TOP-RIGHT: Heading -->
        <Border Classes="StatusPanel"
                Margin="0,40,20,0"
                HorizontalAlignment="Right"
                VerticalAlignment="Top">
            <StackPanel Orientation="Horizontal" Spacing="4">
                <TextBlock Text="{Binding Heading, StringFormat={}{0:F0}}" Foreground="White" FontSize="24" FontWeight="Bold" VerticalAlignment="Center"/>
                <TextBlock Text="Â°" Foreground="#888" FontSize="18" VerticalAlignment="Center"/>
            </StackPanel>
        </Border>

        <!-- LEFT SIDE: Main Controls -->
        <StackPanel Orientation="Vertical" Spacing="12"
                    Margin="20,0,0,0"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Center">

            <!-- Menu Button -->
            <Button Classes="MobileButton" Command="{Binding ToggleFileMenuPanelCommand}">
                <TextBlock Text="â˜°" FontSize="28" Foreground="White" HorizontalAlignment="Center"/>
            </Button>

            <!-- Fields Button -->
            <Button Classes="MobileButton" Command="{Binding ShowFieldSelectionDialogCommand}">
                <TextBlock Text="ðŸ“" FontSize="24" HorizontalAlignment="Center"/>
            </Button>

            <!-- Boundary Button -->
            <Button Classes="MobileButton" Command="{Binding ToggleBoundaryPanelCommand}">
                <TextBlock Text="â¬¡" FontSize="28" Foreground="#E74C3C" HorizontalAlignment="Center"/>
            </Button>

            <!-- Settings -->
            <Button Classes="MobileButton">
                <TextBlock Text="âš™" FontSize="26" Foreground="White" HorizontalAlignment="Center"/>
            </Button>
        </StackPanel>

        <!-- RIGHT SIDE: View Controls -->
        <StackPanel Orientation="Vertical" Spacing="12"
                    Margin="0,0,20,0"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Center">

            <!-- Zoom In -->
            <Button Classes="MobileButton" Command="{Binding ZoomInCommand}">
                <TextBlock Text="+" FontSize="32" Foreground="White" HorizontalAlignment="Center"/>
            </Button>

            <!-- 2D/3D Toggle -->
            <Button Classes="MobileButton" Command="{Binding Toggle3DModeCommand}">
                <TextBlock Text="3D" FontSize="20" Foreground="White" FontWeight="Bold" HorizontalAlignment="Center"/>
            </Button>

            <!-- Zoom Out -->
            <Button Classes="MobileButton" Command="{Binding ZoomOutCommand}">
                <TextBlock Text="âˆ’" FontSize="32" Foreground="White" HorizontalAlignment="Center"/>
            </Button>
        </StackPanel>

        <!-- BOTTOM: Position Info -->
        <Border Classes="StatusPanel"
                Margin="20,0,20,30"
                HorizontalAlignment="Center"
                VerticalAlignment="Bottom">
            <StackPanel Orientation="Horizontal" Spacing="30">
                <StackPanel Orientation="Horizontal" Spacing="6">
                    <TextBlock Text="E" Foreground="#3498DB" FontSize="16" FontWeight="Bold" VerticalAlignment="Center"/>
                    <TextBlock Text="{Binding Easting, StringFormat={}{0:F1}}" Foreground="White" FontSize="18" VerticalAlignment="Center"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal" Spacing="6">
                    <TextBlock Text="N" Foreground="#E74C3C" FontSize="16" FontWeight="Bold" VerticalAlignment="Center"/>
                    <TextBlock Text="{Binding Northing, StringFormat={}{0:F1}}" Foreground="White" FontSize="18" VerticalAlignment="Center"/>
                </StackPanel>
            </StackPanel>
        </Border>

        <!-- BOTTOM-LEFT: Simulator Controls (for testing) -->
        <Border Classes="StatusPanel"
                Margin="20,0,0,30"
                HorizontalAlignment="Left"
                VerticalAlignment="Bottom"
                IsVisible="{Binding IsSimulatorPanelVisible}">
            <StackPanel Orientation="Horizontal" Spacing="8">
                <Button Classes="MobileButtonSmall" Command="{Binding SimulatorSteerLeftCommand}">
                    <TextBlock Text="â—€" FontSize="20" Foreground="White"/>
                </Button>
                <Button Classes="MobileButtonSmall" Command="{Binding SimulatorSteerRightCommand}">
                    <TextBlock Text="â–¶" FontSize="20" Foreground="White"/>
                </Button>
            </StackPanel>
        </Border>

        <!-- BOTTOM-RIGHT: Quick Actions -->
        <StackPanel Orientation="Horizontal" Spacing="12"
                    Margin="0,0,20,30"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Bottom">

            <!-- Simulator Toggle -->
            <Button Classes="MobileButtonSmall" Command="{Binding ToggleSimulatorPanelCommand}">
                <TextBlock Text="ðŸŽ®" FontSize="20"/>
            </Button>
        </StackPanel>

        <!-- SLIDE-IN MENU (when visible) -->
        <Border Background="#EE1a1a1a"
                Width="280"
                HorizontalAlignment="Left"
                VerticalAlignment="Stretch"
                IsVisible="{Binding IsFileMenuPanelVisible}"
                Padding="0,40,0,0">
            <Grid RowDefinitions="Auto,*,Auto">
                <!-- Header -->
                <Border Grid.Row="0" Background="#2C3E50" Padding="20,15">
                    <TextBlock Text="AgValoniaGPS" Foreground="White" FontSize="22" FontWeight="Bold"/>
                </Border>

                <!-- Menu Items -->
                <StackPanel Grid.Row="1" Margin="0,20,0,0">
                    <Button Background="Transparent" Padding="20,15" HorizontalContentAlignment="Left"
                            Command="{Binding ShowFieldSelectionDialogCommand}">
                        <StackPanel Orientation="Horizontal" Spacing="15">
                            <TextBlock Text="ðŸ“‚" FontSize="20"/>
                            <TextBlock Text="Open Field" Foreground="White" FontSize="18" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>
                    <Button Background="Transparent" Padding="20,15" HorizontalContentAlignment="Left"
                            Command="{Binding ResumeFieldCommand}">
                        <StackPanel Orientation="Horizontal" Spacing="15">
                            <TextBlock Text="â–¶ï¸" FontSize="20"/>
                            <TextBlock Text="Resume Last Field" Foreground="White" FontSize="18" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>
                    <Button Background="Transparent" Padding="20,15" HorizontalContentAlignment="Left"
                            Command="{Binding CloseFieldCommand}">
                        <StackPanel Orientation="Horizontal" Spacing="15">
                            <TextBlock Text="âœ–ï¸" FontSize="20"/>
                            <TextBlock Text="Close Field" Foreground="White" FontSize="18" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>
                    <Separator Background="#444" Margin="20,10"/>
                    <Button Background="Transparent" Padding="20,15" HorizontalContentAlignment="Left">
                        <StackPanel Orientation="Horizontal" Spacing="15">
                            <TextBlock Text="âš™ï¸" FontSize="20"/>
                            <TextBlock Text="Settings" Foreground="White" FontSize="18" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>
                    <Button Background="Transparent" Padding="20,15" HorizontalContentAlignment="Left">
                        <StackPanel Orientation="Horizontal" Spacing="15">
                            <TextBlock Text="ðŸ“¡" FontSize="20"/>
                            <TextBlock Text="GPS Configuration" Foreground="White" FontSize="18" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>
                </StackPanel>

                <!-- Close Button -->
                <Button Grid.Row="2" Background="#E74C3C" Padding="20,15" Margin="20"
                        CornerRadius="8" HorizontalContentAlignment="Center"
                        Command="{Binding ToggleFileMenuPanelCommand}">
                    <TextBlock Text="Close Menu" Foreground="White" FontSize="18" FontWeight="Bold"/>
                </Button>
            </Grid>
        </Border>
    </Grid>
</UserControl>
